FROM nginx:1.19
# Copy  nginx config file to container
COPY conf/nginx.conf /etc/nginx/nginx.conf

ENV WEIGHT_SEARCH_2 1
ENV WEIGHT_SEARCH_3 2
ENV WEIGHT_SEARCH_4 3

ENV WEIGHT_SHOP_2 1
ENV WEIGHT_SHOP_3 2
ENV WEIGHT_SHOP_4 3

ENV WEIGHT_WEB_2 1
ENV WEIGHT_WEB_3 2
ENV WEIGHT_WEB_4 3

ENV WEIGHT_MEDIA_2 1
ENV WEIGHT_MEDIA_3 2
ENV WEIGHT_MEDIA_4 3

ENV IP_ADDRESS_NODE_2 131.155.35.52
ENV IP_ADDRESS_NODE_3 131.155.35.53
ENV IP_ADDRESS_NODE_4 131.155.35.54

ENV PORT_ADDRESS_SEARCH_LB 8984
ENV PORT_ADDRESS_SHOP_LB 8097
ENV PORT_ADDRESS_WEB_LB 8081
ENV PORT_ADDRESS_MEDIA_LB 8089

ENV PORT_ADDRESS_SEARCH_SERVER 8983
ENV PORT_ADDRESS_SHOP_SERVER 8096
ENV PORT_ADDRESS_WEB_SERVER 8080
ENV PORT_ADDRESS_MEDIA_SERVER 8088

COPY docker-entrypoint.sh /root/service.sh
CMD ["/bin/bash","/root/service.sh"]